<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farmer Shop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .product-card {
            margin-bottom: 20px;
            transition: transform 0.2s;
        }
        .product-card:hover {
            transform: translateY(-5px);
        }
        .product-image {
            height: 200px;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center">üçé –ú–∞–≥–∞–∑–∏–Ω –§–µ—Ä–º–µ—Ä—Å–∫–∏—Ö –ü—Ä–æ–¥—É–∫—Ç–æ–≤ "–ü—Ä–æ–¥—É–∫—Ç—ã –∏–∑ –¥–µ—Ä–µ–≤–Ω–∏!"</h1>
        
        <div class="row mb-4">
            <div class="col-md-6">
                <input type="text" id="searchInput" class="form-control" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
            </div>
            <div class="col-md-6">
                <select id="categoryFilter" class="form-control">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                </select>
            </div>
        </div>
        
        <div id="productsContainer" class="row">
            <!-- –ü—Ä–æ–¥—É–∫—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>
        
        <div id="loading" class="text-center">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
        </div>
    </div>

    <script>
        // URL –≤–∞—à–µ–≥–æ Spring Boot –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const API_URL = 'http://your-server-ip:8080/api/products';
        // –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π JSON —Ñ–∞–π–ª, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        const LOCAL_JSON = 'products.json';

        async function loadProducts() {
            try {
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å API
                const response = await fetch(API_URL);
                const products = await response.json();
                displayProducts(products);
            } catch (error) {
                console.log('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                // –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
                const response = await fetch(LOCAL_JSON);
                const products = await response.json();
                displayProducts(products);
            }
        }

        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            const loading = document.getElementById('loading');
            const categoryFilter = document.getElementById('categoryFilter');
            
            loading.style.display = 'none';
            container.innerHTML = '';

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            const categories = [...new Set(products.map(p => p.category))];
            categoryFilter.innerHTML = '<option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>' +
                categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');

            products.forEach(product => {
                if (!product.available) return;
                
                const productCard = `
                    <div class="col-md-4 product-card" data-category="${product.category}">
                        <div class="card h-100">
                            ${product.imageUrls && product.imageUrls.length > 0 ? 
                                `<img src="${product.imageUrls[0]}" class="card-img-top product-image" alt="${product.name}">` : 
                                '<div class="card-img-top product-image bg-light d-flex align-items-center justify-content-center">üì¶</div>'
                            }
                            <div class="card-body">
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text">${product.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</p>
                                <p class="text-muted">–§–∞—Å–æ–≤–∫–∞: ${product.amount || '–Ω–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                                <p class="text-muted">–í –Ω–∞–ª–∏—á–∏–∏: ${product.stock} —à—Ç.</p>
                                <h4 class="text-success">${product.price} —Ä—É–±.</h4>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += productCard;
            });

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
            setupFilters();
        }

        function setupFilters() {
            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            
            function filterProducts() {
                const searchTerm = searchInput.value.toLowerCase();
                const selectedCategory = categoryFilter.value;
                
                document.querySelectorAll('.product-card').forEach(card => {
                    const productName = card.querySelector('.card-title').textContent.toLowerCase();
                    const productCategory = card.dataset.category;
                    
                    const matchesSearch = productName.includes(searchTerm);
                    const matchesCategory = !selectedCategory || productCategory === selectedCategory;
                    
                    card.style.display = matchesSearch && matchesCategory ? 'block' : 'none';
                });
            }
            
            searchInput.addEventListener('input', filterProducts);
            categoryFilter.addEventListener('change', filterProducts);
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–¥—É–∫—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', loadProducts);
    </script>
</body>
</html>
